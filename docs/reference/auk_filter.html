<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Filter the EBD using AWK — auk_filter • auk</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
  
  
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">auk</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/auk.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/mstrimas/auk">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter the EBD using AWK</h1>
    </div>

    
    <p>Convert the filters defined in an <code>auk_ebd</code> object into an AWK script and run
this script to produce a filtered eBird Reference Dataset (ERD). The initial
creation of the <code>auk_ebd</code> object should be done with <code><a href='auk_ebd.html'>auk_ebd()</a></code> and filters
can be defined using the various other functions in this package, e.g.
<code><a href='auk_species.html'>auk_species()</a></code> or <code><a href='auk_country.html'>auk_country()</a></code>. <strong>Note that this function typically takes
at least a couple hours to run on the full EBD.</strong></p>
    

    <pre class="usage"><span class='fu'>auk_filter</span>(<span class='no'>x</span>, <span class='no'>file</span>, <span class='no'>file_sampling</span>, <span class='no'>awk_file</span>, <span class='no'>sep</span>, <span class='no'>filter_sampling</span>, <span class='no'>execute</span>,
  <span class='no'>overwrite</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code>auk_ebd</code> object; reference to EBD file created by <code><a href='auk_ebd.html'>auk_ebd()</a></code> with
filters defined.</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>character; output file.</p></td>
    </tr>
    <tr>
      <th>file_sampling</th>
      <td><p>character; optional output file for EBD sampling data.</p></td>
    </tr>
    <tr>
      <th>awk_file</th>
      <td><p>character; output file to optionally save the awk script to.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>character; the input field separator, the EBD is tab separated by
default. Must only be a single character and space delimited is not allowed
since spaces appear in many of the fields.</p></td>
    </tr>
    <tr>
      <th>filter_sampling</th>
      <td><p>logical; whether the EBD sampling event data should
also be filtered.</p></td>
    </tr>
    <tr>
      <th>execute</th>
      <td><p>logical; whether to execute the awk script, or output it to a
file for manual execution. If this flag is <code>FALSE</code>, <code>awk_file</code> must be
provided.</p></td>
    </tr>
    <tr>
      <th>overwrite</th>
      <td><p>logical; overwrite output file if it already exists</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code>auk_ebd</code> object with the output files set. If <code>execute = FALSE</code>,
then the path to the AWK script is returned instead.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>If an EBD sampling file is provided in the <a href='auk_ebd.html'>auk_ebd</a>
object, this function will filter both the EBD and the sampling data using
the same set of filters. This ensures that the files are in sync, i.e. that
they contain data on the same set of checklists.</p>
<p>The AWK script can be saved for future reference by providing an output
filename to <code>awk_file</code>. The default behavior of this function is to generate
and run the AWK script, however, by setting <code>execute = FALSE</code> the AWK script
will be generated but not run. In this case, <code>file</code> is ignored and <code>awk_file</code>
must be specified.</p>
<p>Calling this function requires that the command line utility AWK is
installed. Linux and Mac machines should have AWK by default, Windows users
will likely need to install <a href = 'https://www.cygwin.com'>Cygwin</a>.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># define filters</span>
<span class='no'>filters</span> <span class='kw'>&lt;-</span> <span class='fu'>system.file</span>(<span class='st'>"extdata/ebd-sample.txt"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"auk"</span>) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_ebd.html'>auk_ebd</a></span>() <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_species.html'>auk_species</a></span>(<span class='kw'>species</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Gray Jay"</span>, <span class='st'>"Blue Jay"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_country.html'>auk_country</a></span>(<span class='kw'>country</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"US"</span>, <span class='st'>"Canada"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_extent.html'>auk_extent</a></span>(<span class='kw'>extent</span> <span class='kw'>=</span> <span class='fu'>c</span>(-<span class='fl'>100</span>, <span class='fl'>37</span>, -<span class='fl'>80</span>, <span class='fl'>52</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_date.html'>auk_date</a></span>(<span class='kw'>date</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"2012-01-01"</span>, <span class='st'>"2012-12-31"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_time.html'>auk_time</a></span>(<span class='kw'>time</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"06:00"</span>, <span class='st'>"09:00"</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_duration.html'>auk_duration</a></span>(<span class='kw'>duration</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>60</span>)) <span class='kw'>%&gt;%</span>
  <span class='fu'><a href='auk_complete.html'>auk_complete</a></span>()
<span class='fu'>not_run</span>({
  <span class='co'># temp output file</span>
  <span class='no'>out_file</span> <span class='kw'>&lt;-</span> <span class='fu'>tempfile</span>()
  <span class='fu'>auk_filter</span>(<span class='no'>filters</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>out_file</span>) <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='read_ebd.html'>read_ebd</a></span>() <span class='kw'>%&gt;%</span>
    <span class='fu'>str</span>()
  <span class='co'># clean</span>
  <span class='fu'>unlink</span>(<span class='no'>out_file</span>)
})</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Matthew Strimas-Mackey, Eliot Miller, Wesley Hochachka.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
